Ruby 基础
===========

目标
---------

学习Ruby的基础，着重于和其他编程语言不同的概念。

Hello World
-----------

    $ ruby -e "puts 'Hello World'"
    Hello World

把这端代码放到文件`hello.rb`里。

``` ruby
puts "Hello World" # Hello World
```

用`ruby`来运行.

    $ ruby hello.rb
    Hello World

`'Hello World'` is a `String`, `'Hello World'.class` returns `String`.

``` ruby
puts "Hello World".class # String
puts 'Hello World'.class # String
```

双引号的字符串是被扩展的。

``` ruby
world = "World"
puts "Hello #{world}" # Hello World
puts 'Hello #{world}' # Hello #{world}
```

练 习
--------

找到两种方式来打印出"Hello World"引号里的内容

``` ruby
"Hello World"
"Hello World"
```

字符串
-------

``` ruby
puts "Hello World".downcase # "hello world"
```

操作对象时一般返回对象的拷贝。

``` ruby
s = "Hello World"
puts s.downcase # "hello world"
puts s # "Hello World"
```

方法后加惊叹号（！）有不同的效果，比如会对方法所在的类生效。

``` ruby
puts s.downcase! # "hello world"
puts s # "hello world"
```

Ruby内建正则表达式、

``` ruby
puts "Hello World" =~ /World/
```

你可以用符号`<<-`(这里的横杠-是可选的)来声明一个字符串拆为不同的行，或者使用符号`%q`之后跟上`{}`或者`|`界定的程序块、

``` ruby
s = <<-EOS
 Line 1
 Line 2
EOS

s = %q|
 Line 1
 Line 2
|
```

循环
-----

简单的循环会遍历数组每一个元素。这个写法`1..5`会创建一个类的实例，`(1..5).class`会返回`Range`。

``` ruby
# a simple loop
for i in 1..5
  puts i
end
```

带有迭代器的*block*

``` ruby
# a loop over an array
(1..5).each do |i|
  puts i
end

# a loop 5 times, starts at zero
5.times { |i|
  puts i
}
```

练 习
--------

实现一个循环，打印小于10的所有奇数

    1
    3
    5
    7
    9

条件判断
--------

If-then-else uses `elsif`.

``` ruby
# if / elsif / else
if 2 + 2 == 5
  puts "2+2 is 5"
elsif 2 + 2 == 4
  puts "2+2 is 4"
else
  puts "2+2 is something else"
end
```

Case会评价每一个语句的值，而When可以包含一个表达式。

``` ruby
# case / when / else
case 2 + 2
when 3 + 2 then puts "2+2 is 5"
when 4 then puts "2+2 is 4"
else puts "2+2 is something else"
end
```

数 组
------

你可以循环遍历一个数组里所有的项目。数组经常被成为*容器*，可以装很多不同的类型的东西进去。

``` ruby
[ "rouge", 1, (1..5) ].each do |i|
  puts "#{i} (#{i.class})"
end
```

数组从两头都可以索引，超出数组界限也是合法的。

``` ruby
numbers = [ 1, 2, 3 ]
puts numbers[0] # 1
puts numbers[-1] # 3
puts numbers[5] # nil, converted to an empty string
puts numbers[5].class # NilClass
```

Nil的条目也是对象。

``` ruby
puts [ 1, nil, 3, 5 ].compact # [ 1, 3, 5]
```

内建的数组可以被拉展。

``` ruby
puts [ [ 1, 2 ], [ 3 ], [], 4 ].flatten # [ 1, 2, 3, 4 ]
```

练 习
--------
实现一个case语句，可以显示出数组里的元素是奇数偶数或者字母: [ 1, 7, 'A', 2, 'Z' ]

    1: 奇数
    7: 奇数
    A: 字母
    2: 偶数
    Z: 字母

Hashes
------

也被称为*dictionary*. 

``` ruby
hash = { 
  "red" => "rouge",
  "yellow" => "jaune"
}

hash.each do |entry|
  puts "#{entry[0]} (#{entry[0].class}): #{entry[1][:french]}"
end

hash.each_pair do |name, value|
  puts "#{name}: #{value}"
end
```

Hash的键和值可以是任意类型。一般习惯使用*symbols*作为hash的键，hash作为值。

``` ruby
hash = { 
  :red => { :french => "rouge", :russian => "красный" },
  :yellow => { :french => "jaune", :russian => "жёлтый" }
}

hash.each_pair do |name, value|
  puts "#{name} (#{name.class}): #{value[:french]}"
end

puts hash[:red][:russian] # "красный"
```

Mapping
-------

给每一个元素一个代码块执行，然后返回一个新的集合。

``` ruby
puts [ 1, 2 ].map{ |i| i * 2 } # 2, 4

puts [ 1, nil, 3, 5 ].map { |i| i.nil? } # false, true, false, false
```

Injecting
---------

``` ruby
[ 1, 2, 3, 4 ].inject(0) { |result, element| result + element } # => 10
```

Chaining
-------

对象可以被tap，创造一个写lambda的机会。

``` ruby
1.tap{ |i| puts i }.tap { |i| puts i * 2 } # 1, 2
```

Operators
---------

下列办法就可以实现平方

``` ruby
3 ** 2 # returns 9
```

用一个有名字的方法或者操作符，就可以把一个值push到数组的底端。

``` ruby
[1,2].push 3 # returns [1,2,3]

[1,2] << 3 # returns [1,2,3]
```

`||` 会检查值是不是`nil`或者`false`的, 如果是的话，就返回右部的值

``` ruby
nil || "empty" # returns "empty"

false || "value" # returns "value"
```

`||=`在变量为nil或者没有定义的时候创建或者分配值给它。

``` ruby
variable ||= "memoized string"
```

Next
====

Let's look at [Ruby OOP](2.2-ruby-oop.md).

