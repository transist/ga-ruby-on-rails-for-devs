Git引言
===================

目 标
---------

学习Git的基础知识，并且理解在Ruby和Ruby on Rails的生态系统种，Github在扮演什么样的角色。学习更多的概念，比如*snapshot*, *repository*, *pull*, *push* and *topical branches*、

Git
---

Git是一个开源的很快的分布式版本控制系统。和CVS、SourceSafe, ClearCase, Subversion 或者 Perforce不一样，但有点像Mercurial。分布式意思是它可以离线工作。Git是Ruby和Ruby on Rails生态系统必要的一环。

Git 快照
-------------

一个git的commit是所有文件和元信息在给定时间的快照，而不是文件的差别。

一个新的Git Repository
--------------------

离线创造一个GIT repostory。我们管这个叫*red*.

    $ mkdir ga
    $ cd ga
    ga$ mkdir red
    ga$ cd red

    ga/red$ git init
    Initialized empty Git repository in /home/dblock/sourcega/red/.git/

    ga/red$ touch README.md

    ga/red$ git add README.md

    ga/red$ git status

    # On branch master
    #
    # Initial commit
    #
    # Changes to be committed:
    #   (use "git rm --cached <file>..." to unstage)
    #
    #	new file:   README.md
    #

    ga/red$ git commit -m "Added README."
    [master (root-commit) 3923738] Added README.
     0 files changed, 0 insertions(+), 0 deletions(-)
     create mode 100644 README.md

    ga/red$ 

练习
--------

修改*README.md*里的内容，以[Markdown](http://daringfireball.net/projects/markdown/syntax)里的格式提交变更的。

我们的本地Repository
---------------------------

在我们的*本地* repository里，我们之前的commit替换了我们的变更，这是一个在Git和Hg这样的分布式版本管理系统里独有的概念。

验证*本地* repository的提交历史.

    ga/red$ git log

    commit 392373835e0f7702251d45a088664918e9125c97
    Author: dblock
    Date:   Mon Dec 5 09:34:08 2011 -0500

    Added README.

推送到一个远程的Repository: Github
-----------------

[在Github上创建一个新的repository](https://github.com/repositories/new)，叫*red*. 这是一个没有文件的空repository. Github会在他们自己的服务器上运行像我们刚才运行的那样的命令。

我们通过新添一个被称为*origin*的远程位置，就可以连接我们本地的*red* repository到Github的repository

    ga/red$ git remote add origin git@github.com:<username>/red.git

我们可以通过一下命令来查看远程的branch

    ga/red$ git remote
    origin

把我们所有的变更push到Github

    ga/red$ git push -u origin master

下一次你可以push所有未决的变更到所有的分支

    ga/red$ git push

和*pushing*相反的是*pulling*。下列的命令会从远程*master* branch更新变更到本地。

    ga/red$ git pull origin master 

Cloning
-------

使用`git clone`可以从已经存在的一个Github repository得到一份拷贝到自己的本地机器上。

    ga$ git clone git@github.com:<username>/red.git green

这样，就创建了一个新的文件夹叫*green*，而内容是来自*red* repository，它是一个从Github的*remote* repository克隆过来的*local* repository。

Topic Branches
----------------

和其他的一些源代码控制不一样，Git的分支开销很小。在Git圈，人们通常认为不在*master*分支上工作，而是创建一个*topic branches*来代替是很好的实践。一个topic branch是创建自master的。

首先，列出你的分支，你会看到你在*master*分支上。

    ga/red$ git branch

确保*master*总是保持最新。

    ga/red$ git pull origin master 

创建一个新的分支*readme-changes*。

    ga/red$ git checkout -b readme-changes
    Switched to a new branch 'readme-changes'

    ga/red$ git status
    # On branch readme-changes
    nothing to commit (working directory clean)

在这个分支上做一点改版，确认变更(commit)并且把他们push到Github.

    ga/red$ git push origin readme-changes

当分支上的特性已经完成了，就可以把这个分支合并(merge)到*master*。

    ga/red$ git checkout master
    ga/red$ git merge readme-changes

可视化查看分支
-------------------

在Git内部，变更加入到了log，人们可以可视化的查看每一个单独的分支。

    ga/red$ git log --graph

用内建的有图形界面的GitK来查看这视图。

    ga/red$ gitk

练 习
--------

在你的本地*red* repository里的README文件里做一些改变，然后*push*到Github，然后*pull*到本地的*green*分支。

Forking
-------

为了继续其他人的工作，通过Github创建一个新的*fork*，然后克隆你的Fork到你本地环境去。使用*pull requests*来提交变更。

设置一个‘upstream’远程repository，就可以把以前的变更pull到最早的代码里去。

    ga/red$ git remote add upstream git@github.com:<original_author>/<upstream_source>.git

    ga/red$ git remote
    origin
    upstream

运行以下的命令，可以把所有的变更pull到upstream。

    ga/red$ git pull upstream master

练 习
--------

结对的fork对方的repositories，克隆你的fork，然后做一点改变到*README.md*并且创建一个pull request。验证Github上的差别，然后河北这个pull request。如果创建了一个topic branch可以获得更多的分数。
